{
  "hash": "4b7ea054c1e2dad9b786c19a9c9d5353",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Q5 – Airport with Highest Average Delay per Airline\"\n---\n\n# Question\n\n**For each airline, find the airport where it has the highest average departure delay.  \nOutput the airline name, the airport name, and the value of that average delay.**\n\n## SQL Query\n\nThe SQL Query used to answer this question is provided below.\n\n```sql\nWITH avg_delays AS (\n  SELECT\n    Reporting_Airline AS airline,\n    OriginAirportName AS airport_name,\n    OriginAirportCode AS airport_code,\n    AVG(GREATEST(DepDelay, 0)) AS avg_delay\n  FROM al_perf\n  GROUP BY Reporting_Airline, OriginAirportName, OriginAirportCode\n),\nranked AS (\n  SELECT\n    airline,\n    airport_name,\n    airport_code,\n    avg_delay,\n    RANK() OVER (PARTITION BY airline ORDER BY avg_delay DESC) AS rnk\n  FROM avg_delays\n)\nSELECT\n  airline,\n  airport_name,\n  airport_code,\n  avg_delay\nFROM ranked\nWHERE rnk = 1\nORDER BY airline;\n```\n\n## Output \n\nThe output of this SQL query is saved as `Question 5 output.csv`, and is provided below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nq5 <- read_csv(\"data/Question 5 output.csv\")\nq5\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 19 × 3\n   airline           airport_name              avg_delay\n   <chr>             <chr>                         <dbl>\n 1 9E                Charleston/Dunbar, WV         292. \n 2 AA                Hayden, CO                     41.5\n 3 AS                Adak Island, AK                41.8\n 4 B6                Newburgh/Poughkeepsie, NY      50.7\n 5 DL                Roanoke, VA                    47.9\n 6 EV                Burlington, VT                 63.1\n 7 F9                Columbus, OH                   33  \n 8 G4                Clarksburg/Fairmont, WV       109. \n 9 HA                Oakland, CA                    20.9\n10 MQ                Florence, SC                   47.3\n11 NK                Latrobe, PA                    27.1\n12 OH                New York, NY                   27.7\n13 OO                Tampa, FL                      98.5\n14 Reporting_Airline OriginCityName                  0  \n15 UA                Asheville, NC                  39.2\n16 VX                Kona, HI                       33.6\n17 WN                Los Angeles, CA                26.4\n18 YV                Killeen, TX                    36.7\n19 YX                Greer, SC                      42  \n```\n\n\n:::\n:::\n\n\n## Visualization\n\n\n::: {.cell}\n\n```{.r .cell-code}\nq5 %>%\nggplot(aes(x = reorder(airline, avg_delay), y = avg_delay)) +\ngeom_col(fill = \"#4C72B0\") +\ncoord_flip() +\nlabs(\ntitle = \"Airline Worst-Delay Airport (Highest Avg Delay)\",\nx = \"Airline\",\ny = \"Average Delay at Worst Airport (minutes)\"\n) +\ntheme_minimal(base_size = 14)\n```\n\n::: {.cell-output-display}\n![](q5_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nThe chart shows the airport where each airline experiences its highest average departure delay, revealing large differences between carriers. One airline in particular (9E) faces dramatically higher delays at its worst airport—nearly 300 minutes on average—far exceeding all others. This highlights how operational bottlenecks can be highly localized and suggests that targeted improvements at specific airports could significantly reduce delays for certain airlines.",
    "supporting": [
      "q5_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}